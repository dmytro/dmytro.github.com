<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="revisit-after" content="30 days">
<meta name="robots" content="index, follow">

<title>Package Watcher | rpm | monitoring | ruby | Dmytro Kovalov</title>

<meta name="description" content="Package Watcher is Linux file-system monitoring utility aimed at tracking and saving file changes. It is built as Ruby framework and command line script. Package Watcher uses Ruby library factories for collecting and committing (saving) files change information.
">


<meta name="keywords" content="rpm,monitoring,ruby,linux,change management,enterprise,packaging,itil,rpm"/>
<meta name="revised" content="Dmytro Kovalov,  2011/11/11" />

<meta name="author" content="Dmytro Kovalov" />

<link rel="icon" href="/images/favicon.ico">

<link href='http://fonts.googleapis.com/css?family=Noto+Sans&subset=latin,cyrillic-ext' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Seymour+One&subset=latin,cyrillic' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Comfortaa&subset=latin,cyrillic-ext' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Lobster&subset=latin,cyrillic-ext' rel='stylesheet' type='text/css'>

<link rel="stylesheet" type="text/css" href="/css/cssnormalize-min.css">
<link rel="stylesheet" href="/css/dmytro.css" type="text/css">
<link rel="stylesheet" href="/css/pygments.css" type="text/css">

<meta name="thefeedbackbutton" content="Github:ed4d541b3268b2dc5250684b57864d">
<script type="text/javascript" src="http://www.thefeedbackbutton.com/button.js"></script>

<style>#TheFeedbackButton { top: 270px !important; }</style>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-33505287-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<link rel="stylesheet" href="/css/fancybox.css" />
<script src="/js/fancybox.js" async="async"></script>
</head><body>
<div id="fb-root"></div>
<script type="text/javascript">(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

<!-- Place this tag after the last +1 button tag. -->
<script type="text/javascript">
  (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  })();
</script>
















<div id="tiki-top">
<table style="margin: 0; padding: 0;" cellspacing="0" cellpadding="0" width="100%" columns="3"><tbody><tr style="padding: 0; margin: 0;">
 <td style="width:120px; 
background-color:#D9A005;  
color:#8b0b04; 
font-wight: bold; 
text-align: right;
padding: 1em;
padding-top: 2em;
border:0; 
border-right: 10px solid #000;">
<p class="motto plus">Лупайте сю скалу...</p><p class='motto'>Іван Франко</p>
</td>
 <td style="border:0;">
    <a href="http://yarylo.sytes.net/"><img align="right" border="0" src="/images/yarylo.png"></a>
    <br clear="all"><div id="top_bar_title">
    <a href="http://yarylo.sytes.net/dmytro" style="color: #8B0B04;">Уроки пані Маєш</a>
   </div>

<div style="float: left">
  <div class="fb-like" data-send="false" data-layout="button_count" data-width="450" data-show-faces="true"></div>
  <div align="right" class="g-plusone" data-size="medium"></div>
</div>

<div style="float: right; padding: 5px;">
  <div ><img height="14" width="14" src="/images/feed-icon-14x14.png">&nbsp;<a href="rss.xml">RSS</a> | <a href="atom.xml">Atom</a></div>
</div>

</td>
 <td style="border: 0;border-left: 10px solid #000; width:200px; background-color:#8B0B04;">
   <p class="editdate" style="font-size: small; color: #D9A005; margin: 5px; margin-top: 100px; margin-right: 80px;">
     15 August 2013
   </p>
 </td>
</tr></tbody></table>  </div>


  <div id="tiki-mid">
    <table border="0" cellpadding="0" cellspacing="0">
    <tbody><tr>
      <td id="leftcolumn"> <p id="preamble"><a class="top" href="/"><h1>TOP &raquo;</h1></a><p>

<div id='tag_cloud'>

<a style='text-shadow: -4px 4px 4px rgba(0, 0, 0, 0.2);' href="/tags.html#mac" title="mac" rel="7">mac</a>

<a style='text-shadow: -4px 4px 4px rgba(0, 0, 0, 0.2);' href="/tags.html#history" title="history" rel="8">history</a>

<a style='text-shadow: -4px 4px 4px rgba(0, 0, 0, 0.2);' href="/tags.html#solaris" title="solaris" rel="1">solaris</a>

<a style='text-shadow: -4px 4px 4px rgba(0, 0, 0, 0.2);' href="/tags.html#email" title="email" rel="2">email</a>

<a style='text-shadow: -4px 4px 4px rgba(0, 0, 0, 0.2);' href="/tags.html#sendmail" title="sendmail" rel="1">sendmail</a>

<a style='text-shadow: -4px 4px 4px rgba(0, 0, 0, 0.2);' href="/tags.html#cli" title="cli" rel="7">cli</a>

<a style='text-shadow: -4px 4px 4px rgba(0, 0, 0, 0.2);' href="/tags.html#nfs" title="nfs" rel="1">nfs</a>

<a style='text-shadow: -4px 4px 4px rgba(0, 0, 0, 0.2);' href="/tags.html#configuration" title="configuration" rel="12">configuration</a>

<a style='text-shadow: -4px 4px 4px rgba(0, 0, 0, 0.2);' href="/tags.html#interesting" title="interesting" rel="1">interesting</a>

<a style='text-shadow: -4px 4px 4px rgba(0, 0, 0, 0.2);' href="/tags.html#linux" title="linux" rel="6">linux</a>

<a style='text-shadow: -4px 4px 4px rgba(0, 0, 0, 0.2);' href="/tags.html#debian" title="debian" rel="4">debian</a>

<a style='text-shadow: -4px 4px 4px rgba(0, 0, 0, 0.2);' href="/tags.html#xwindow" title="xwindow" rel="1">xwindow</a>

<a style='text-shadow: -4px 4px 4px rgba(0, 0, 0, 0.2);' href="/tags.html#css" title="css" rel="3">css</a>

<a style='text-shadow: -4px 4px 4px rgba(0, 0, 0, 0.2);' href="/tags.html#disk" title="disk" rel="1">disk</a>

<a style='text-shadow: -4px 4px 4px rgba(0, 0, 0, 0.2);' href="/tags.html#books" title="books" rel="1">books</a>

<a style='text-shadow: -4px 4px 4px rgba(0, 0, 0, 0.2);' href="/tags.html#fun" title="fun" rel="1">fun</a>

<a style='text-shadow: -4px 4px 4px rgba(0, 0, 0, 0.2);' href="/tags.html#cobbler" title="cobbler" rel="1">cobbler</a>

<a style='text-shadow: -4px 4px 4px rgba(0, 0, 0, 0.2);' href="/tags.html#installation" title="installation" rel="3">installation</a>

<a style='text-shadow: -4px 4px 4px rgba(0, 0, 0, 0.2);' href="/tags.html#troubleshooting" title="troubleshooting" rel="2">troubleshooting</a>

<a style='text-shadow: -4px 4px 4px rgba(0, 0, 0, 0.2);' href="/tags.html#ntp" title="ntp" rel="1">ntp</a>

<a style='text-shadow: -4px 4px 4px rgba(0, 0, 0, 0.2);' href="/tags.html#environment" title="environment" rel="3">environment</a>

<a style='text-shadow: -4px 4px 4px rgba(0, 0, 0, 0.2);' href="/tags.html#perl" title="perl" rel="1">perl</a>

<a style='text-shadow: -4px 4px 4px rgba(0, 0, 0, 0.2);' href="/tags.html#request tracker" title="request tracker" rel="2">request tracker</a>

<a style='text-shadow: -4px 4px 4px rgba(0, 0, 0, 0.2);' href="/tags.html#ruby" title="ruby" rel="9">ruby</a>

<a style='text-shadow: -4px 4px 4px rgba(0, 0, 0, 0.2);' href="/tags.html#development" title="development" rel="3">development</a>

<a style='text-shadow: -4px 4px 4px rgba(0, 0, 0, 0.2);' href="/tags.html#gem" title="gem" rel="1">gem</a>

<a style='text-shadow: -4px 4px 4px rgba(0, 0, 0, 0.2);' href="/tags.html#nagios" title="nagios" rel="4">nagios</a>

<a style='text-shadow: -4px 4px 4px rgba(0, 0, 0, 0.2);' href="/tags.html#monitoring" title="monitoring" rel="4">monitoring</a>

<a style='text-shadow: -4px 4px 4px rgba(0, 0, 0, 0.2);' href="/tags.html#nagira" title="nagira" rel="4">nagira</a>

<a style='text-shadow: -4px 4px 4px rgba(0, 0, 0, 0.2);' href="/tags.html#ssh" title="ssh" rel="1">ssh</a>

<a style='text-shadow: -4px 4px 4px rgba(0, 0, 0, 0.2);' href="/tags.html#tmux" title="tmux" rel="2">tmux</a>

<a style='text-shadow: -4px 4px 4px rgba(0, 0, 0, 0.2);' href="/tags.html#tips" title="tips" rel="8">tips</a>

<a style='text-shadow: -4px 4px 4px rgba(0, 0, 0, 0.2);' href="/tags.html#unix" title="unix" rel="3">unix</a>

<a style='text-shadow: -4px 4px 4px rgba(0, 0, 0, 0.2);' href="/tags.html#shell" title="shell" rel="3">shell</a>

<a style='text-shadow: -4px 4px 4px rgba(0, 0, 0, 0.2);' href="/tags.html#zsh" title="zsh" rel="1">zsh</a>

<a style='text-shadow: -4px 4px 4px rgba(0, 0, 0, 0.2);' href="/tags.html#prompt" title="prompt" rel="1">prompt</a>

<a style='text-shadow: -4px 4px 4px rgba(0, 0, 0, 0.2);' href="/tags.html#RESTful API" title="RESTful API" rel="3">RESTful API</a>

<a style='text-shadow: -4px 4px 4px rgba(0, 0, 0, 0.2);' href="/tags.html#blog" title="blog" rel="9">blog</a>

<a style='text-shadow: -4px 4px 4px rgba(0, 0, 0, 0.2);' href="/tags.html#github" title="github" rel="2">github</a>

<a style='text-shadow: -4px 4px 4px rgba(0, 0, 0, 0.2);' href="/tags.html#jekyll" title="jekyll" rel="2">jekyll</a>

<a style='text-shadow: -4px 4px 4px rgba(0, 0, 0, 0.2);' href="/tags.html#chef" title="chef" rel="1">chef</a>

<a style='text-shadow: -4px 4px 4px rgba(0, 0, 0, 0.2);' href="/tags.html#capistrano" title="capistrano" rel="1">capistrano</a>

<a style='text-shadow: -4px 4px 4px rgba(0, 0, 0, 0.2);' href="/tags.html#deployment" title="deployment" rel="1">deployment</a>

<a style='text-shadow: -4px 4px 4px rgba(0, 0, 0, 0.2);' href="/tags.html#Japan" title="Japan" rel="6">Japan</a>

<a style='text-shadow: -4px 4px 4px rgba(0, 0, 0, 0.2);' href="/tags.html#Ukrainian" title="Ukrainian" rel="6">Ukrainian</a>

<a style='text-shadow: -4px 4px 4px rgba(0, 0, 0, 0.2);' href="/tags.html#travel" title="travel" rel="6">travel</a>

<a style='text-shadow: -4px 4px 4px rgba(0, 0, 0, 0.2);' href="/tags.html#culture" title="culture" rel="6">culture</a>

</div>
</p>


<h1 class="even">Selected projects  <a style="float: right" href="/github.html"><b>See all &raquo; </b></a> </h1>






<a href="/aws-deploy.html">AWS Deploy</a>



<a href="/banalize.html">Banalize: Bash static code analyzer</a>





<a href="/dbi-report-excel.html">DBIx::Report::Excel</a>



<a href="/dotfiles/index.html">Shell settings, AKA dotfiles</a>







<a href="/github_keys/index.html">Github keys</a>











<a href="/nagios_couchbase.html">Nagios Monitoring for Couchbase server</a>







<a href="/nagira/index.html">Nagira: RESTful API for Nagios</a>















<a href="/rfb.html">Ready For Business Automation system</a>





<a href="/rspec_normalized_hash/index.html">RSpec tests for Normalized Hash</a>



























<a href="/Web-iPhoto/index.html">Web iPhoto</a>



<h1>Blog <a style="float: right" href="/posts.html"><b>All posts &raquo; </b></a> </h1>


<a href="/2013/08/13/more_about_jekyll.html">Github & Jekyll: More experience with Jekyll and setup changes </a>

<a href="/2013/07/29/day_8_tazawako.html">Літо на півночі Японії: День восьмий: Найглибше озеро Японії </a>

<a href="/2013/07/29/day_4_chusonji.html">Літо на півночі Японії: День четвертий: багато буддистських святинь </a>

<a href="/2013/07/25/day_5to7_tokoton_yama_II.html">Літо на півночі Японії: Автокемпінг Токотон-яма (II) </a>

<a href="/2013/07/25/day_5to7_tokoton_yama_I.html">Літо на півночі Японії: Три дні в Токотон-яма (I). Сукава онсен. </a>

<a href="/2013/07/24/day_three_yamadera.html">Літо на півночі Японії: День третій: Окама і Ямадера </a>

<a href="/2013/07/23/druhyi_den.html">Літо на півночі Японії: Другий день </a>

<a href="/2013/05/21/easy_spawn_new_hosts_with_capistrano.html">Build new hosts with Capistrano and Chef </a>

<a href="/2013/05/15/custom_css_for_rt4.html">Request Tracker: More about custom CSS for RT4 </a>

<a href="/2013/03/18/ruby_2_test_drive.html">Ruby 2 test drive </a>


<h1 class="even">Slides <a style="float: right" href="/presentations"><b>See all &raquo; </b></a> </h1>












































<a href=/presentations/nagira_tlug.html>Nagira @TLUG, 2012</a>



<a href=/presentations/rspec_and_guard.html>Rspec and Guard</a>



































<h1>About</h1>

<a href="http://uk.wikipedia.org/wiki/%D0%AF%D1%80%D0%B8%D0%BB%D0%BE">Ярило, Yarylo, Jarilo</a>
<a href="http://github.com/dmytro"> @ github</a>
<a href="http://search.cpan.org/~dmytro"> @ CPAN</a>
<a href="http://tinyurl.com/7j89dhl"> Dmytro (CV)</a>
<p><p> </td>
      <td id="centercolumn">


<div class="wikitext">
<div class="titlebar">
     Package Watcher
    
</div>




<script type="text/javascript" charset="utf-8" src="/js/jquery.js"></script>

<script type="text/javascript">
         $("document").ready(function() {
         createTOC(
                     'h1,h2,h3,h4,h5,h6' ,
            'TOC   ');
    });

// tag : the header tag for which the toc is to be built
// container : id of the div that we want to append the resulting TOC.
function createTOC(tag, container) {
    var anchorCount = 0;  // count to create unique id

    // create an unordered list
    var oList = $("<ul id='bookmarksList'>");
    /*
      1. For each header tag create a named anchor and insert the into header tag.  It will
      serve as the jump location for the TOC.
      2. Add the link to the unordered list that will point to the named anchor.  
    */

    /* Get all h3 inside div where id is not equal to header.
    // For each h3 tag
    //    1. Create the named anchor.  This should be a unique name.
    //    2. Set the html for h3 tag to a named anchor.
    //    3. Add the existing html for the h3 in front of the named anchor.  
    //    4. Create the TOC links
    //    5. Add the TOC to the container.
    */
$('#content').children(tag).each(function() { 
//    $("div([header]) " + tag).each(function() { 

        $(this).html("<a name='bookmark" + anchorCount + "'></a>" +
		     $(this).html());
        oList.append($("<li class='" + this.nodeName +"'><a href='#bookmark" + anchorCount++ + "'>"
		       + $(this).text() + "</a></li>"));
    });
    $("#" + container).append(oList);
}
</script>

    <style>

      #TOC.bookmarkList li { list-style-type: none; }
      li:first-child { text-indent: 0; }
      
    .H1, .H2, .H3, .H4, .H5, .H6 {  display: block; }

    .H1 { text-indent: 0; font-size: 100%; }
    .H2 { text-indent: 2ex; font-size: 90%; }
    .H3 { text-indent: 4ex; font-size: 80%; }
    .H4 { text-indent: 6ex; font-size: 70%; }
    .H5 { text-indent: 8ex; font-size: 60%; }
    .H6 { text-indent: 10ex; font-size: 50%; }
    </style>




<strong id="toc_title">Table Of Contents</strong>
<div id="TOC"></div>




<div id="content">


<h1>Linux(<span class="caps">UNIX</span>) file changes monitor and tracker</h1>
<p>
<table>
	<tr>
		<td> Development environment </td>
		<td> RedHat Linux (RHEL5) </td>
	</tr>
	<tr>
		<td> Ruby </td>
		<td> (1.9.1/1.9.2) </td>
	</tr>
	<tr>
		<td> Author	 </td>
		<td> Dmytro Kovalov </td>
	</tr>
	<tr>
		<td> Year </td>
		<td>	 2010 </td>
	</tr>
</table>
<h1>Description</h1>
<p>Package Watcher is Linux file-system monitoring utility aimed at tracking and saving file changes. It is built as Ruby framework and command line script. Package Watcher uses Ruby library factories for collecting and committing (saving) files change information.</p>
<h1>Background</h1>
<p>On most modern Linux systems Package Management Systems (<span class="caps">PMS</span>) are charged with the task of organizing all of the packages installed on a system including verifying file check-sums to ensure correct and complete packages. Software packages can be easily re-installed on the same or different host from software repository.</p>
<p>Problem arises when server has un-packaged software installed on the host or when files managed by <span class="caps">PMS</span> are changed after installation (as for example, many of the configuration files).</p>
<p>To track changes of such files it is not enough to rely on <span class="caps">PMS</span> and some other tool should be used. In many cases full system backup is the only tool allowing to keep track of file changes.</p>
<p>Full system backup is usually resource intensive and expensive solution, requiring large amount of storage.</p>
<p>Additionally software repositories already provide reliable source of software packages, and there is no need to store files installed by <span class="caps">PMS</span>.</p>
<p>Following information is required to (re)build Linux server:</p>
<ul>
	<li>List of software packages (<span class="caps">RPM</span>, pkg etc) and versions;</li>
	<li>Repository of all files managed by <span class="caps">PMS</span>, changed since installation;</li>
	<li>Repository of all files not managed by <span class="caps">PMS</span>;</li>
</ul>
<h1>Package Watcher</h1>
<p>Package Watcher is a tool filling the gap and providing simple way of identifying files that need tracking outside of <span class="caps">PMS</span> and storing files using one of the version control system or by backup tool.</p>
<p>Package Watcher relies on tools available in Linux system to track un-packaged files or files that have changed since installation time and stores all the files needed tracking in version control system.</p>
<p>Package Watcher is built as a set of several Ruby factories making it easy to select particular library depending on the needs. For example, subsystem of tracking server files relies on <ins>locate</ins> command, but can be changed to use <ins>find</ins> as well. Tracking packaged files use RedHat? <span class="caps">RPM</span> database, but depending on underlying OS, can be changed to use Solaris <ins>pkg</ins> or Debian style <ins>dpkg</ins>. Similarly, version control subsystem is built with Subversion support, but any other version control or file backup system can be used instead (<ins>git</ins>, <ins>rsync</ins> etc).</p>
<p>Diagram below shows logical diagram of Package Watcher.</p>
<p><img src="/images/rpmwarden/Watcher_flow.png" alt="" /></p>
<h3>Libraries</h3>
<p>Following factories are implemented (or partially implemented) at the time of the writing:</p>
<table>
	<tr>
		<td> Package::Watcher::Files </td>
		<td> Factory for constructing list of files on the host. Currently implemented of factory &#8216;driver&#8217; Package::Watcher::Locatedb , other possible plug-ins can be, for example, Find. </td>
	</tr>
	<tr>
		<td> Package::Watcher::Package </td>
		<td> Factory for constructing list of files belonging to packages installed on the host and list of files that are changed since installation time. Currently implemented Package::Watcher::Rpm , others can be Pkg or Deb, for example. </td>
	</tr>
	<tr>
		<td> Package::Watcher::Exclusion </td>
		<td> <br />
  Exclusion factory handles list of files to be excluded from commits. Configurable option relies on configuration file (by default ./etc/warden.yml). See <span class="caps">CONFIGURATION</span> for details. </td>
	</tr>
	<tr>
		<td> Package::Watcher::VC </td>
		<td> Version Control factory. Currently implemented Subversion plug-in: Package::Watcher::Svn , possible candidates: Package::Watcher::Git , Package::Watcher::Rsync , etc. </td>
	</tr>
</table>
<h3>Factory Modules Relationship Diagram</h3>
<p><img src="/images/rpmwarden/Watcher_factories.png" alt="" /></p>
<h1>Author</h1>
<p>Dmytro Kovalov</p>
<p>Tokyo, 2010, Dec</p>


</div> <!-- content -->

</table>


<div id="tiki-bot">
  <table style="border-:0; border-top: 10px solid #000; margin: 0; padding: 0; " cellspacing="0" cellpadding="0" width="100%" columns="2">
  <tbody><tr style="padding: 0; margin: 0;"> 
<td style="width: 80%; background-color:#052D6C;  color:#8b0b04; font-style: italic; font-wight: bold; text-align: right; border:0;">
<br clear="all"><br clear="all"><br clear="all"><br clear="all">
</td><td style="border: 0;border-left: 10px solid #000; width:120px; padding: 5px;">
<a class="address" href="mailto:dmytro.kovalov@gmail.com">дмитро ковальов</a></br>
<a class="address" href="https://dmytro.github.com/">dmytro @ github </a><br>
<a class="address" href="http://dmytro.sytes.net">dmytro.sytes.net</a><br>
</td>
</tr></tbody></table>
</div>
<script>$("#content table tr:even").attr("class", "even");</script>
<script src="/js/jquery.js" type="text/javascript" charset="utf-8"></script> 
<script src="/js/jquery.tagcloud.js" type="text/javascript" charset="utf-8"></script> 
<script language="javascript">
$.fn.tagcloud.defaults = {
    size: {start: 0.7, end: 2.5, unit: 'em'},
    color: {start: '#8B0B04', end: '#8B1C04'}
};
 
$(function () {
    $('#tag_cloud a').tagcloud();
});
</script>



</body></html>